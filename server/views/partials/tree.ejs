<% /* server/views/partials/tree.ejs */ %>
<ul class="tree-list children" data-parent-id="<%= typeof parentId !== 'undefined' ? parentId : '' %>">
  <% (nodes || []).forEach(function(node){ %>
    <li class="tree-node" data-id="<%= node.id %>">
      <div class="node-row">
        <span class="node-handle">⠿</span>
        <span class="node-title">
          <strong>#<%= node.id %></strong>
          — <%= node.title || '(không tiêu đề)' %>
          <% if (node.slug) { %> <code>/ <%= node.slug %></code> <% } %>
        </span>
        <span class="node-actions">
          <a class="btn btn-xs btn-outline-primary" href="/admin/pages/<%= node.id %>/edit">Sửa</a>
          <form action="/admin/pages/<%= node.id %>/trash" method="post" class="d-inline">
            <input type="hidden" name="_csrf" value="<%= csrfToken %>">
            <button class="btn btn-xs btn-outline-danger" onclick="return confirm('Chuyển page #<%= node.id %> vào Trash?')">Xoá</button>
          </form>
        </span>
      </div>

      <% if ((node.children||[]).length) { %>
        <%- include('tree', { nodes: node.children, parentId: node.id }) %>
      <% } else { %>
        <ul class="children" data-parent-id="<%= node.id %>"></ul>
      <% } %>
    </li>
  <% }) %>
</ul>
