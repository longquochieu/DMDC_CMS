<ul class="list-unstyled" id="cat-tree-root">
  <% function renderNode(node){ %>
    <li data-node-id="<%= node.id %>" class="mb-1">
      <div class="d-flex align-items-center gap-2 border rounded px-2 py-1 bg-white draggable-handle" style="cursor:grab">
        <span class="text-muted">#<%= node.id %></span>
        <strong><%= node.name || '(Không tên)' %></strong>
        <% if (node.slug) { %>
          <small class="text-secondary">/<%= node.slug %></small>
        <% } %>

        <div class="ms-auto btn-group btn-group-sm">
          <a class="btn btn-outline-primary" href="/admin/categories/<%= node.id %>/edit">Sửa</a>
          <form action="/admin/categories/<%= node.id %>/trash" method="post"
                onsubmit="return confirm('Chuyển vào Thùng rác?')">
            <input type="hidden" name="_csrf" value="<%= csrfToken %>">
            <button class="btn btn-outline-danger">Xoá</button>
          </form>
        </div>
      </div>

      <% if (node.children && node.children.length) { %>
        <ul class="list-unstyled ms-4 mt-1">
          <% node.children.forEach(renderNode) %>
        </ul>
      <% } %>
    </li>
  <% } %>

  <% (nodes||[]).forEach(renderNode) %>
</ul>
