<%- include('../partials/flash') %>
<div class="row">
  <div class="col-lg-6">
    <div class="card">
      <div class="card-header"><strong>Thông tin tài khoản</strong></div>
      <div class="card-body">
        <form method="post" action="/admin/users/me">
		<input type="hidden" name="_csrf" value="<%= csrfToken %>">
          <div class="form-group">
            <label>Username</label>
            <input type="text" class="form-control" value="<%= me.username %>" readonly>
          </div>
          <div class="form-group">
            <label>Email</label>
            <input type="email" class="form-control" name="email" value="<%= me.email||'' %>" required>
          </div>
          <div class="form-group">
            <label>Display name</label>
            <input type="text" class="form-control" name="display_name" value="<%= me.display_name||'' %>">
          </div>
          <button class="btn btn-primary">Lưu</button>
        </form>
      </div>
    </div>
  </div>
  <div class="col-lg-6">
    <div class="card">
      <div class="card-header"><strong>Ảnh đại diện</strong></div>
      <div class="card-body">
        <% if (me.avatar_path){ %>
          <img src="<%= me.avatar_path %>" style="width:80px;height:80px;object-fit:cover;border-radius:50%" class="mb-2">
        <% } %>
        <form method="post" enctype="multipart/form-data" action="/admin/users/me/avatar">
			<input type="hidden" name="_csrf" value="<%= csrfToken %>">
          <input type="file" name="avatar" accept=".jpg,.jpeg,.png,.webp,.svg" required>
          <button class="btn btn-secondary ml-2">Tải lên</button>
        </form>
      </div>
    </div>
    <div class="card mt-3">
      <div class="card-header"><strong>Đổi mật khẩu</strong></div>
      <div class="card-body">
        <form method="post" action="/admin/users/me/password">
		<input type="hidden" name="_csrf" value="<%= csrfToken %>">
          <div class="form-group">
            <label>Mật khẩu hiện tại</label>
            <input type="password" class="form-control" name="current_password" required>
          </div>
          <div class="form-group">
            <label>Mật khẩu mới</label>
            <input type="password" class="form-control" name="new_password" minlength="8" required>
          </div>
          <div class="form-group">
            <label>Xác nhận mật khẩu</label>
            <input type="password" class="form-control" name="confirm_password" minlength="8" required>
          </div>
          <button class="btn btn-warning">Đổi mật khẩu</button>
          <a class="btn btn-outline-danger ml-2" href="#" onclick="event.preventDefault(); document.getElementById('logout-all-form').submit();">Đăng xuất tất cả</a>
        </form>
        <form id="logout-all-form" method="post" action="/admin/users/me/logout-all">
			<input type="hidden" name="_csrf" value="<%= csrfToken %>">
		</form>
      </div>
    </div>
  </div>
</div>
